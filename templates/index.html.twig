{% extends "base.html.twig" %}
{% block title %}
    Casa de Don Alonso
{% endblock %}

{% block styles %}
    {{ parent() }}
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/css/bootstrap-datepicker.min.css"
    />
    <link
        rel="stylesheet"
        href="{{ asset('/assets/css/slide.css') }}"
    />
{% endblock %}

{% block scripts %}
    {{ parent() }}
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/js/bootstrap-datepicker.min.js"
    >
    </script>

    <script>
        $(document).ready(function() {
            $('.js-datepicker').datepicker({
                format: 'dd-mm-yyyy'
            }).on('changeDate', function(e){
                $(this).datepicker('hide');
                var fromS = $('#booking_fromDate').val().split('-');
                var toS = $('#booking_toDate').val().split('-');
                var fromDate = fromS.length === 3 
                             ? new Date(fromS[2], fromS[1] - 1, fromS[0])
                             : null;
                var toDate = toS.length === 3
                            ? toS && new Date(toS[2], toS[1] - 1, toS[0])
                            : null;

                var popup = $('.error-popup').first();
                var datesAreFilled = fromDate !== null && toDate !== null;
                var invalidDates = toDate <= fromDate;
                if (datesAreFilled && invalidDates) {
                    $('.js-datepicker').addClass('has-error');
                    popup.html('La fecha de salida debe ser posterior a la de entrada');
                    var ref = $('#booking_toDate');
                    var refWidth = ref.width();
                    var popper = new Popper(ref, popup, {
                        placement: 'bottom'
                    });
                    popup.width(refWidth + 20);
                    popup.removeClass('invisible');
                } else {
                    popup.addClass('invisible');
                    $('.js-datepicker').removeClass('has-error');
                    popup.html('');
                }
            });
        });
    </script>
{% endblock %}

{% block body %}
    <div class="header-desktop">
        {% include 'common/header.html.twig' %}
    </div>
    <div class="background"></div>
    <div class="container booking-form-container">
        {% include 'forms/booking-form.html.twig' with {'form': form} %}
        <div class='error-popup invisible'></div>
    </div>
    <div class="section-separator"></div>
    <div class="house-section container" id="about">
        <h1>Sobre la casa</h1>
        <div class="img-container row">
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/da01.jpg') }}" alt="" />
            </div>
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/da02.jpg') }}" alt="" />
            </div>
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/da03.jpg') }}" alt="" />
            </div>
        </div>
        <div class="house-info row">
            <div class="col-md-12 text-center">
                Una casa espectacular, con <strong>382 m2 construidos</strong> divididos en varios espacios y ambientes.
            </div>
        </div>
    </div>

    <div class="house-section container" id="salon">
        <div class="row">
            <div class="img-medium col-md-6">
                <img src="{{ asset('/assets/img/da04.jpg') }}" alt="" />
            </div>
            <div class="img-medium col-md-6">
                <img src="{{ asset('/assets/img/da05.jpg') }}" alt="" />
            </div>
        </div>
    </div>

    <div class="house-section container" id="bedrooms">
        <h1>Dormitorios y ocupación</h1>
        <div class="img-container row">
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/casa-rural-don-alonso-dormitorio-01.jpg') }}" alt="" />
            </div>
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/casa-rural-don-alonso-dormitorio-02.jpg') }}" alt="" />
            </div>
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/casa-rural-don-alonso-dormitorio-03.jpg') }}" alt="" />
            </div>
        </div>
        <div class="house-info row">
            <div class="col-md-12 text-center">
                Seis dormitorios, dobles y triples, con camas de 135, 150 y 190 cm, donde pueden hospedarse hasta <strong>16 personas.</strong><br/>
                La planta de arriba cuenta también con <strong>tres baños completísimos,</strong> además de una agradable zona de lectura o de juegos de mesa.
            </div>
        </div>
        <div class="img-container row">
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/casa-rural-don-alonso-aseo-planta-alta.jpg') }}" alt="" />
            </div>
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/casa-rural-don-alonso-zona-lectura-planta-alta.jpg') }}" alt="" />
            </div>
            <div class="img-small col-md-4">
                <img src="{{ asset('/assets/img/casa-rural-don-alonso-planta-alta.jpg') }}" alt="" />
            </div>
        </div>
    </div>
{% endblock %}